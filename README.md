# Amazon Data Analysis using SQL 

## Overview 
This project involves a comprehensive analysis on "Amazon" dataset using SQL.The goal is to extract valuable insights from "Amazon" dataset on Product,Customer,Sales and answer the business questions based on the dataset.
The following Readme will provide all the information about the project.

## Objective
'''sql
** There are Three Branches and Cities to observing highest revenue generated.
** Idenitify the Sales,Prodcut,Customers Analysis on the given Dataset.
** Observing the Customer ratings on each Products.
** It will Helps to enhance the business sales.
'''

## Dataset 
I will Upload the dataset it sepeartly in repository.

## Schema 
``` sql
create schema amazon;
use amazon ; 
 
drop table if exists sales; 
create table sales 
(
    	Invoiceid varchar(50),
        Branch varchar(50),
        city varchar(50),
        customertype varchar(50),
        gender varchar(20),
        productline varchar(40),
        unitPrice float, 
        quantity int,
        tax float ,
        total float,
        date varchar(50),
        time varchar(50),
        payment varchar(50),
        cogs float,
        grossmargin float ,
        grossincome float,
        rating float 
);

```
### Handling Missing Values through the dataset 
```sql
select 
	sum(case when invoiceid is null then 1 else 0 end) invoiceid_null_values, 
    sum(case when branch is null then 1 else 0 end) branch_null_values,
    sum(case when city is null then 1 else 0 end) city_null_values ,
    sum(case when customertype is null then 1 else 0 end) customertype_null_values ,
    sum(case when gender is null then 1 else 0 end) gender_null_values ,
    sum(case when productline is null then 1 else 0 end) productline_null_values,
    sum(case when unitprice is null then 1 else 0 end) unitprice_null_values ,
    sum(case when quantity is null then 1 else 0 end) quantity_null_values ,
    sum(case when tax is null then 1 else 0 end) tax_null_values ,
    sum(case when total is null then 1 else 0 end) total_null_values ,
    sum(case when date is null then 1 else 0 end) date_null_values ,
    sum(case when time is null then 1 else 0 end) time_null_values ,
    sum(case when payment is null then 1 else 0 end) payment_null_values ,
    sum(case when cogs is null then 1 else 0 end) cogs_null_values ,
    sum(case when grossmargin is null then 1 else 0 end) grossmargin_null_values ,
    sum(case when grossincome is null then 1 else 0 end) grossincome_null_values,
    sum(case when rating is null then 1 else 0 end) rating_null_values
from sales;
```
## Objective: Handling missing values for each row and column.
```sql
## Adding new column "Timeofday" for retriving sales on days wise.

Alter table sales
add column timeofday varchar(50); ### adding column timeofday

set sql_safe_updates = 0; ### using this method when we forgot where clause for specific condition then it throughs an error it hadles that error 

update  sales ## updating the timeofday null values instead of 'Morning, Afternoon, Evening, Night' by the given time 
set timeofday = 
				case
                when hour(time) between 6 and 11 then 'Morning'
                when hour(time) between 11 and 15 then 'Afternoon'
                when hour(time) between 15 and 19 then 'Evening' 
                else 'Night'
                end ;
                
```

## Business Questions and Answers

## 1.How many Branch and City are represented in given dataset. 
```sql
select 
    	branch,
        city 
from sales 
group by 1,2
order by 1;
```
## 2.Total revenue generated by each Branch and City. 
```sql 
select 
    	Branch,
        city, 
        sum(total) total_revenue
from sales
group by 1,2
order by 2 desc;
```

## 3.How much Total and Average Revenue generated by the sales.
```sql
    
select 
	sum(total) total_revenue ,
    avg(total) avg_revenue 
from sales ;

```
## 4.Highest Revenue Generated by each productline.
```sql
select 
	productline,
    sum(total) total_revenue 
from sales 
group by 1
order by total_revenue desc;
```

## 5.Which Productline has generated least sales.
```sql
select 
	productline,
    sum(total) total_revenue 
from sales 
group by 1
order by total_revenue ;
```

## 6.How much quantity sold for each product line.
``` sql
select 
	productline,
    sum(quantity) total_quantity 
from sales 
group by 1 
order by 2 desc;
```

## 7.For Each Product line Highest rating by customers.
``` sql

select 
	distinct customertype,
    productline,
    rating
from 
		(select 
			customertype,
			productline,
			rating,
			dense_rank() over(partition by customertype,productline order by rating desc) rnk 
		from sales 
) customer_rating 
where rnk = 1;
```

## 8.Which customer type has generated highest revenue.
``` sql
select 	
	customertype ,
    sum(total) total_revenue 
from sales 
group by 1;
```
## 9.which customer type has generated highest revenue on each product line.
``` sql
with product_sales as (
select 
	customertype,
    productline,
    sum(total) over(partition by customertype,productline) rnk 
from sales
)
select 
	customertype,
    productline,
    max(rnk) 
from product_sales 
group by 1,2 ;
```
## 10.Which customer type has generated highest revenue using Ewallet.
``` sql
select 
	customertype,
    payment,
    sum(total) revenue
from sales 
group by 1,2 
having payment = 'Ewallet'
order by revenue desc;
```

## Findings and Conclusions:
** Sales Analysis : Branch C and city Naypyitaw generated highest revenue.
** Product Analysis : Food and beverages has generated highest revenue comapre to remaining products. 
** Customer Analysis : There are two types of customers they prefer to sold Electronic accessories.

## Conclusions 
** Analysing this dataset the customer ratings has higher for Electronic accessories.Here i identified If we Increase sales on Electronic accessories then it will generate more revenue.  
